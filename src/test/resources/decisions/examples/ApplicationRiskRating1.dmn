<?xml version="1.0" encoding="UTF-8"?>
<Definitions id="ApplicationRiskRating" namespace="http://omny.link/decisions/examples"
  xmlns="http://www.omg.org/spec/DMN/20130901" 
  xmlns:ol="http://omny.link/decisions"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.omg.org/spec/DMN/20130901 schema/DMN.xsd "
  expressionLanguage="http://www.ecma-international.org/ecma-262/5.1/"
  name="Application Risk Decisions">
  
   <ItemDefinition id="applicantDef" isCollection="false" name="Applicant" typeLanguage="http://www.ecma-international.org/ecma-404/">
     <description>Domain model definition for a single applicant.</description>
   </ItemDefinition>
   <ItemDefinition id="conclusionDef" isCollection="false" name="conclusion" typeLanguage="http://www.ecma-international.org/ecma-404/">
     <description>Domain model definition for a single conclusion (policy).</description>
   </ItemDefinition>
   
   <BusinessKnowledgeModel id="bkm0" name="Applicant Model">
     <description>Business Knowledge Model describing the Applicants for the Health Insurance domain</description>
     <InformationItem id="contact" name="contact">
       <description>An applicant for health insurance</description>
       <itemDefinition>applicantDef</itemDefinition>
     </InformationItem>
     <LiteralExpression expressionLanguage="http://www.ecma-international.org/ecma-262/5.1/" id="idvalue2" name="conclusion">
       <description>The conclusion being created for the applicant</description>
       <itemDefinition>conclusionDef</itemDefinition>
       <text/>
     </LiteralExpression>
     <!-- <knowledgeRequirement>
       <requiredKnowledge>QName</requiredKnowledge>
     </knowledgeRequirement>
     <authorityRequirement>
       <requiredDecision>QName</requiredDecision>
     </authorityRequirement> -->
  </BusinessKnowledgeModel>
       
  <Decision id="DetermineApplicantRiskRating" name="Determine applicant's risk rating">
    <description>Determines health insurance applicant's risk rating</description>
    <question>What is the risk rating for the specified health insurance applicant?</question>
    <allowedAnswers>"High", "Medium", "Low"</allowedAnswers>
   
    <DecisionTable 
        aggregation="COLLECT" 
        hitconclusion="UNIQUE" 
        id="dt0" 
        isComplete="true" 
        isConsistent="true" 
        name="Applicant Risk Rating" 
        preferedOrientation="Rule-as-Column">
      <description>Calculate applicant risk rating based on age and health</description>
      <clause>
        <inputExpression id="dt0_c0_ie" ol:type="LiteralExpression">
          <description>The applicant's age</description>
          <inputVariable>contact</inputVariable>
        </inputExpression>
        <inputEntry id="over60" ol:type="LiteralExpression">
          <description>Is the applicant over 60?</description>
          <inputVariable>contact</inputVariable>
          <text>contact.age >60</text>
        </inputEntry>
        <inputEntry id="between25And60" ol:type="LiteralExpression">
          <description>Is the applicant between 25 and 60?</description>
          <inputVariable>contact</inputVariable>
          <text>contact.age >=25 &amp;&amp; contact.age &lt;= 60</text>
          </inputEntry>
        <inputEntry id="under25" ol:type="LiteralExpression">
           <description>Is the applicant under 25?</description>
           <inputVariable>contact</inputVariable>
           <text>contact.age &lt; 25</text>
        </inputEntry>
      </clause>
      <clause>
        <inputExpression id="dt0_c1_ie" ol:type="LiteralExpression">
          <description>The applicant's health</description>
          <inputVariable>contact</inputVariable>
        </inputExpression>
        <inputEntry id="inGoodHealth" ol:type="LiteralExpression">
          <description>Is the applicant in good health?</description>
          <inputVariable>contact</inputVariable>
          <text>contact.health == 'Good'</text>
         </inputEntry>
         <inputEntry id="inBadHealth" ol:type="LiteralExpression">
           <description>Is the applicant in bad health?</description>
           <inputVariable>contact</inputVariable>
           <text>contact.health == 'Bad'</text>
         </inputEntry>
      </clause>
      <clause>
        <outputDefinition id="dt0_c2_od">conclusion</outputDefinition>
        <outputEntry id="highRisk" ol:type="LiteralExpression">
           <description>Applicant is high risk</description>
           <inputVariable>conclusion</inputVariable>
           <text>conclusion.riskRating = 'High'</text>
        </outputEntry>
        <outputEntry id="mediumRisk" ol:type="LiteralExpression">
           <description>Applicant is medium risk</description>
           <inputVariable>conclusion</inputVariable>
           <text>conclusion.riskRating = 'Medium'</text>
        </outputEntry>
        <outputEntry id="lowRisk" ol:type="LiteralExpression">
           <description>Applicant is low risk</description>
           <inputVariable>conclusion</inputVariable>
           <text>conclusion.riskRating = 'Low'</text>
        </outputEntry>
      </clause>
      <rule>
        <condition>over60</condition>
        <condition>inGoodHealth</condition>
        <conclusion>mediumRisk</conclusion>
      </rule>
      <rule>
        <condition>over60</condition>
        <condition>inBadHealth</condition>
        <conclusion>highRisk</conclusion>
      </rule>
      <rule>
        <condition>between25And60</condition>
        <condition></condition>
        <conclusion>mediumRisk</conclusion>
      </rule>
      <rule>
        <condition>under25</condition>
        <condition>inGoodHealth</condition>
        <conclusion>lowRisk</conclusion>
      </rule>
      <rule>
        <condition>under25</condition>
        <condition>inBadHealth</condition>
        <conclusion>mediumRisk</conclusion>
      </rule>
    </DecisionTable>
  
  </Decision>

</Definitions>
